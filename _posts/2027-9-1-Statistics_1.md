---
title: 统计（1）正态性检验方法
tags: Statistics
typora-root-url: ./..
---

直方图（核密度估计曲线）、P-P图、Q-Q图、箱线图、Shapiro-Wilk检验、Kolmogorov-Smirnov检验、Anderson-Darling 检验、Lilliefors 检验、Jarque-Bera 检验。

<!--more-->

https://blog.csdn.net/weixin_52300428/article/details/147403470

##### 1.Shapiro-Wilk正态性检验：小样本正态性检验的黄金标准

这种方法之所以能够有效检验正态性，是因为它巧妙地利用了正态分布的顺序统计量具有特定期望值和协方差结构的特性。如果数据真的来自正态分布，那么样本顺序统计量的适当线性组合应该与样本方差成正比。从本质上讲，W统计量反映的是观测数据在QQ图中线性回归斜率的平方，这直接度量了数据与理论正态分布的相关程度。
Shapiro-Wilk检验的临界值最初通过Monte Carlo模拟得到，并制成了详细的临界值表。对于不同的样本量和显著性水平，都有相应的临界值。现代统计软件通常使用Royston提出的近似方法来计算p值。对于小样本（n≤50），使用精确的模拟结果或查表方法；对于大样本（n>50），则使用近似公式进行计算。在进行假设检验时，零假设是数据来自正态分布总体，备择假设是数据不来自正态分布总体。如果计算得到的W统计量小于临界值，或者p值小于显著性水平（通常取0.05），则拒绝零假设，认为数据显著偏离正态分布。
Shapiro-Wilk检验被公认为是所有正态性检验中功效最强的方法，特别适合小样本检验。它具有扎实的理论基础，数学推导严谨可靠，被主流统计软件广泛采用。然而，这种方法也存在一些局限性。在大样本情况下，它可能过度敏感，检测到实际上不重要的微小偏差。

##### 2.Kolmogorov-Smirnov检验：经典的非参数检验方法

这个检验方法的理论基础是Glivenko-Cantelli定理，该定理证明了当样本量趋于无穷时，经验分布函数一致收敛于真实的分布函数。K-S检验的基本原理是比较观测数据的经验分布函数与假设的理论分布函数之间的最大垂直距离。如果数据确实来自假设的分布，这个最大距离应该相对较小。这种方法之所以能反映正态性，是基于一致性原理：如果数据真正来自正态分布，那么经验分布函数应该接近标准正态分布的累积分布函数。
##### 3.Anderson-Darling检验：对分布尾部敏感的检验方法

A-D检验属于经验分布函数检验族，是Cramér-von Mises类统计量的加权版本。它的核心思想是，当给定假设分布时，数据的累积分布函数可以转换为均匀分布，通过测量经验分布函数与理论分布函数之间的加权距离来评估拟合优度。

三种检验方法的功效排序为：Shapiro-Wilk检验 > Anderson-Darling检验 > Kolmogorov-Smirnov检验。

在小样本情况下（n < 50），Shapiro-Wilk检验是首选，因为它专门为小到中等样本设计，功效最高。中等样本量（50 ≤ n ≤ 300）是进行可靠正态性评估的最佳范围，此时Shapiro-Wilk或Anderson-Darling检验都是不错的选择。当样本量很大（n > 5000）时，情况变得复杂。所有检验方法都可能变得过度敏感，即使微小的、实际上不重要的偏离也可能被检测为统计显著。此时，更应该依赖图形方法如Q-Q图、直方图等进行判断，或者适当放宽显著性水平。
